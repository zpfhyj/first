#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f anly.sh 
#endif

static  char data [] = 
#define      pswd_z	256
#define      pswd	((&data[18]))
	"\275\175\067\077\242\015\166\100\162\311\274\316\265\045\234\300"
	"\256\110\236\005\251\317\204\027\263\304\376\254\070\121\330\346"
	"\010\002\237\072\046\274\013\233\130\255\225\335\173\173\040\117"
	"\116\277\125\367\216\332\017\101\236\016\356\327\137\307\275\150"
	"\311\134\242\360\031\256\214\161\133\041\117\327\235\160\047\353"
	"\057\174\343\275\127\362\377\365\001\355\314\140\265\212\310\177"
	"\346\153\157\000\031\373\161\165\035\300\114\272\060\164\246\140"
	"\361\211\035\110\174\034\076\176\012\013\336\277\225\247\076\174"
	"\023\256\174\054\252\355\241\310\256\356\203\337\143\051\077\124"
	"\263\135\235\060\172\333\256\205\346\215\105\174\065\203\370\110"
	"\062\164\165\335\142\027\245\021\006\050\361\151\122\061\276\006"
	"\216\133\066\011\066\345\216\035\162\323\231\250\127\221\361\211"
	"\006\146\146\151\175\014\172\204\064\153\355\207\234\254\215\053"
	"\007\303\065\076\251\303\133\033\227\365\304\356\207\265\170\216"
	"\033\337\367\231\353\161\036\040\335\014\247\172\270\064\246\277"
	"\370\333\376\241\237\132\275\066\117\201\045\326\067\235\144\122"
	"\174\134\354\150\316\012\211\253\026\060\046\317\145\314\217\136"
	"\250\215\327\337\156\246\105\073\065\243\343\303\244\052\252\141"
	"\250\341\241\112\357\027\212\141\341\107\060\227\155\315\127\034"
	"\025\057\373\204\325\101\300\013\345\244\316\211\316\171\353\167"
	"\132\214\301\112\244\114\254\205\224\334\034\001"
#define      msg2_z	19
#define      msg2	((&data[334]))
	"\300\244\207\025\105\013\207\272\237\340\040\362\010\261\224\154"
	"\147\130\044\052\003"
#define      msg1_z	65
#define      msg1	((&data[357]))
	"\132\005\205\100\274\010\002\234\137\162\314\170\247\017\365\027"
	"\000\227\314\366\315\021\243\326\317\351\107\371\133\041\162\212"
	"\176\067\154\075\010\314\126\364\021\302\051\011\075\337\122\362"
	"\300\137\151\375\312\357\156\270\035\046\353\140\064\375\047\011"
	"\132\045\202\230\302\251\124\311\170\315\264\357\050"
#define      shll_z	10
#define      shll	((&data[432]))
	"\345\376\005\355\056\056\340\146\223\235\102\244\036"
#define      lsto_z	1
#define      lsto	((&data[443]))
	"\166"
#define      tst1_z	22
#define      tst1	((&data[447]))
	"\374\261\145\115\264\372\145\317\270\025\106\371\077\040\213\241"
	"\036\106\242\060\121\101\131\066\111\241\313\252"
#define      date_z	1
#define      date	((&data[472]))
	"\021"
#define      rlax_z	1
#define      rlax	((&data[473]))
	"\177"
#define      chk2_z	19
#define      chk2	((&data[474]))
	"\335\005\040\107\053\201\074\256\071\211\212\151\210\106\242\317"
	"\200\115\117\303\343\301\353"
#define      inlo_z	3
#define      inlo	((&data[497]))
	"\260\370\377"
#define      xecc_z	15
#define      xecc	((&data[501]))
	"\164\130\301\171\142\012\277\231\371\205\301\357\035\362\027\016"
	"\003"
#define      chk1_z	22
#define      chk1	((&data[522]))
	"\035\371\111\203\232\012\003\076\030\037\262\204\032\310\064\103"
	"\350\364\327\005\350\173\260\323\223\253\271\024\055\266"
#define      opts_z	1
#define      opts	((&data[547]))
	"\356"
#define      text_z	3294
#define      text	((&data[727]))
	"\316\012\020\262\313\373\326\077\131\340\260\326\124\264\116\121"
	"\113\153\112\224\357\345\251\035\233\342\373\363\202\063\100\121"
	"\075\120\003\011\114\332\110\246\272\371\174\017\255\313\141\371"
	"\066\254\216\046\221\067\103\055\032\076\040\235\161\141\356\256"
	"\261\362\267\376\315\000\244\210\371\041\227\246\354\371\240\043"
	"\245\056\111\067\145\214\145\200\313\206\035\074\347\013\353\231"
	"\376\243\227\313\243\074\123\235\136\353\103\113\344\343\157\212"
	"\022\271\301\167\106\047\367\021\255\024\116\224\040\072\055\036"
	"\335\305\351\201\002\074\036\140\050\142\254\014\106\033\226\130"
	"\324\130\320\032\177\307\054\054\334\172\301\375\264\356\033\222"
	"\263\005\023\266\102\061\026\152\224\302\167\332\336\016\062\262"
	"\147\002\315\305\211\246\070\357\142\234\174\123\107\243\001\023"
	"\073\221\324\100\376\066\074\256\245\177\313\221\372\317\001\100"
	"\150\302\242\243\216\055\156\065\270\051\032\266\304\027\337\075"
	"\275\052\144\344\322\063\155\242\210\167\376\253\307\115\161\316"
	"\212\044\214\133\216\062\377\356\354\076\333\020\166\156\136\221"
	"\355\055\126\330\335\026\116\107\245\256\063\140\334\147\100\123"
	"\140\330\076\207\345\202\356\051\046\150\151\335\276\226\116\334"
	"\200\074\035\052\067\347\375\051\125\367\156\266\034\031\141\355"
	"\123\246\214\076\007\120\143\212\305\022\263\203\237\113\053\367"
	"\210\362\315\307\336\234\152\270\210\357\342\001\361\300\363\242"
	"\224\073\232\320\331\162\070\332\256\000\071\133\340\207\237\273"
	"\164\344\170\166\307\354\131\143\263\147\140\211\077\333\056\033"
	"\304\147\257\250\070\211\204\356\247\023\164\024\120\272\316\263"
	"\253\177\015\165\300\135\313\131\264\157\233\111\007\214\307\041"
	"\266\302\025\175\301\226\032\175\042\377\327\015\370\266\371\050"
	"\055\313\320\212\214\147\336\011\256\063\141\024\013\330\172\326"
	"\162\010\066\227\066\004\346\121\026\154\154\070\013\152\270\221"
	"\075\373\256\343\374\342\215\314\275\350\060\120\121\032\000\366"
	"\311\101\315\264\162\322\261\134\017\101\326\166\174\022\153\207"
	"\137\226\074\031\337\214\312\243\256\123\327\324\072\032\250\341"
	"\122\260\017\207\130\104\362\330\001\375\362\102\252\270\272\176"
	"\351\264\357\300\036\223\347\201\050\241\047\276\066\374\317\225"
	"\367\053\317\365\166\330\251\025\014\163\347\245\375\225\306\302"
	"\055\244\337\301\135\146\132\100\143\137\146\131\324\160\051\351"
	"\260\315\116\067\127\347\230\342\141\022\047\046\253\205\205\214"
	"\377\345\263\333\074\003\305\101\017\134\301\205\121\341\311\074"
	"\354\326\111\004\266\064\121\237\331\301\077\153\215\257\234\107"
	"\304\240\163\255\360\103\102\127\266\175\321\322\201\132\312\102"
	"\233\244\037\257\313\052\177\001\073\267\103\040\074\231\310\032"
	"\053\356\246\027\331\126\203\145\247\263\006\102\036\203\373\107"
	"\160\251\315\157\274\271\100\131\310\332\047\202\115\235\023\323"
	"\215\351\204\032\061\344\350\304\147\217\305\374\325\132\302\231"
	"\023\327\161\256\220\260\030\332\131\312\165\020\327\325\140\021"
	"\335\000\376\015\015\246\325\224\156\255\317\167\347\110\070\352"
	"\352\310\254\013\015\255\336\045\324\053\370\176\256\005\072\330"
	"\304\020\227\014\072\130\044\335\146\275\031\316\060\031\353\133"
	"\231\273\365\220\212\012\070\322\327\375\174\354\331\201\357\056"
	"\117\033\302\055\056\037\314\033\032\350\361\336\333\247\244\272"
	"\377\253\363\062\352\143\122\322\324\071\333\100\101\143\005\013"
	"\016\252\221\127\273\004\150\276\034\105\147\067\173\067\253\050"
	"\055\230\150\012\103\056\022\066\061\157\015\112\201\205\033\017"
	"\063\115\316\203\226\060\146\017\302\151\204\075\217\343\257\304"
	"\336\031\006\106\336\142\150\166\117\367\235\364\064\116\044\076"
	"\145\056\225\060\357\241\112\056\223\326\271\324\233\140\236\366"
	"\241\251\226\272\377\273\020\266\167\250\270\257\127\310\036\254"
	"\334\251\066\224\004\100\334\317\102\025\013\154\215\312\345\245"
	"\120\354\040\202\132\067\023\352\276\050\354\003\143\246\111\203"
	"\231\321\131\053\333\212\160\303\242\062\215\022\106\153\353\135"
	"\020\033\044\273\011\366\321\202\217\123\334\147\347\227\271\064"
	"\324\140\314\315\101\274\217\234\117\131\037\007\362\025\146\323"
	"\254\206\053\315\331\263\036\046\201\030\306\000\320\313\306\105"
	"\367\121\061\120\131\156\161\043\140\134\352\371\266\322\177\146"
	"\231\306\104\045\276\103\030\006\126\334\311\121\215\370\055\364"
	"\246\226\220\051\223\366\313\121\335\201\257\370\202\154\126\141"
	"\253\233\040\164\233\306\110\070\317\004\022\207\256\250\170\104"
	"\066\133\200\222\376\151\050\211\270\277\141\255\362\012\314\056"
	"\042\232\006\254\323\231\302\045\272\213\341\302\342\302\112\212"
	"\141\010\147\346\074\135\073\360\015\274\026\247\027\161\300\233"
	"\253\212\241\132\130\311\206\145\075\242\074\332\020\156\273\255"
	"\276\263\245\234\326\174\005\351\102\042\226\263\233\135\254\167"
	"\247\305\312\066\307\362\201\076\112\264\305\103\234\060\142\263"
	"\224\077\152\315\175\263\347\004\034\315\263\007\361\060\057\242"
	"\033\361\026\101\256\324\044\246\067\365\246\372\202\205\166\220"
	"\067\302\266\167\313\216\220\221\061\150\310\214\272\054\223\051"
	"\036\013\172\374\247\224\312\347\351\051\204\003\265\231\067\330"
	"\067\036\153\161\021\140\075\135\047\251\272\071\336\377\046\040"
	"\077\031\371\142\044\267\360\254\355\007\323\214\302\265\026\261"
	"\332\044\127\257\104\124\161\000\225\013\255\064\063\274\156\073"
	"\221\150\031\275\362\215\360\023\364\232\376\207\135\157\060\041"
	"\073\130\100\266\150\153\174\323\235\262\323\152\033\162\376\174"
	"\170\103\171\227\217\262\305\045\036\211\361\073\117\362\110\107"
	"\037\263\152\201\233\174\221\165\050\177\032\112\121\001\016\010"
	"\375\266\275\146\144\252\365\324\100\145\244\301\301\200\146\012"
	"\031\250\214\336\360\045\204\353\300\007\365\125\141\047\021\070"
	"\353\367\015\274\130\132\163\243\267\350\343\330\322\277\257\254"
	"\110\147\316\245\366\146\317\370\374\326\363\254\172\133\327\066"
	"\121\141\057\235\315\266\224\175\157\015\243\347\106\344\116\242"
	"\217\121\221\207\333\273\313\340\013\326\017\021\104\372\022\112"
	"\250\051\172\151\271\044\001\154\310\343\075\203\125\003\331\221"
	"\044\274\312\152\343\362\115\327\305\104\315\316\217\346\112\223"
	"\071\341\312\075\365\231\373\302\246\056\074\340\270\156\165\031"
	"\306\162\253\216\133\254\001\141\026\202\015\075\067\077\126\316"
	"\314\065\022\153\013\246\356\176\300\176\033\344\002\166\051\327"
	"\311\024\234\204\227\067\323\043\132\130\147\250\340\046\347\373"
	"\025\105\043\051\242\307\105\114\037\207\345\304\016\123\347\242"
	"\255\023\175\202\147\257\206\326\034\044\201\245\021\207\301\241"
	"\123\204\343\265\230\320\233\042\141\000\047\351\241\125\071\155"
	"\053\000\356\265\111\052\155\267\124\067\162\372\172\266\126\301"
	"\360\361\222\365\250\070\007\002\257\020\312\116\252\124\214\165"
	"\204\122\373\027\077\313\224\145\154\164\011\211\214\211\341\054"
	"\022\006\040\174\304\113\267\235\374\137\054\131\050\050\206\114"
	"\042\342\064\117\116\236\264\320\147\233\222\015\264\064\157\277"
	"\373\164\365\350\204\073\346\323\004\021\051\271\054\026\151\314"
	"\115\116\255\031\163\317\262\305\107\360\155\067\034\036\247\207"
	"\074\234\042\345\070\177\272\134\372\111\037\011\304\346\324\114"
	"\176\321\070\214\117\011\215\233\336\362\102\226\273\332\311\120"
	"\277\136\112\067\023\150\245\226\232\356\152\011\006\317\246\064"
	"\375\004\135\020\262\376\330\374\366\270\220\143\147\177\257\152"
	"\310\311\260\206\023\361\301\277\132\356\052\350\023\073\323\135"
	"\356\363\131\130\266\327\063\311\113\220\341\061\224\302\256\267"
	"\137\145\140\053\073\073\055\372\214\132\313\053\022\264\163\102"
	"\123\011\227\020\234\006\025\251\100\105\362\132\320\351\245\273"
	"\040\036\363\352\345\252\216\033\224\034\333\346\167\204\120\131"
	"\040\353\037\067\074\302\246\314\116\265\207\065\147\132\150\325"
	"\332\157\310\073\046\130\104\356\107\204\341\144\163\177\347\237"
	"\133\301\220\102\051\260\235\260\101\066\053\376\275\062\330\137"
	"\304\227\155\314\300\360\035\147\070\103\304\217\355\312\007\007"
	"\133\326\314\341\216\135\371\060\303\030\126\124\111\131\171\134"
	"\334\224\216\221\177\144\374\017\063\100\131\267\257\077\246\115"
	"\004\343\212\333\054\273\223\312\311\202\017\220\056\267\243\056"
	"\325\371\205\051\262\367\020\016\170\243\125\025\020\140\306\025"
	"\105\060\245\260\221\045\351\055\033\222\113\325\067\153\173\234"
	"\204\233\165\333\201\255\244\204\076\274\055\115\330\373\047\356"
	"\262\255\302\324\135\213\303\234\023\075\214\272\333\026\011\371"
	"\363\044\026\013\335\033\262\335\063\377\053\027\266\036\246\104"
	"\037\200\072\142\026\251\226\356\055\301\006\037\243\027\351\243"
	"\372\145\116\223\167\303\142\222\043\310\332\206\142\172\134\177"
	"\104\325\346\102\362\105\151\064\250\300\243\045\311\353\167\066"
	"\136\247\260\360\122\201\150\355\214\160\345\157\107\224\156\213"
	"\350\225\103\146\017\307\153\266\137\317\320\107\310\222\025\065"
	"\143\102\100\360\153\350\007\360\322\324\371\303\041\207\357\363"
	"\275\176\143\244\114\047\175\062\255\135\277\034\270\345\236\240"
	"\130\247\117\102\372\350\317\356\032\301\033\237\020\033\041\317"
	"\062\230\126\120\316\264\273\072\316\022\030\145\261\074\171\143"
	"\204\042\225\154\354\065\114\011\077\063\253\010\071\356\242\345"
	"\013\151\300\073\130\025\312\314\047\207\067\256\323\117\124\064"
	"\330\136\113\370\244\165\330\057\265\053\277\127\144\274\031\350"
	"\243\171\215\046\312\134\147\153\254\263\032\243\073\332\126\157"
	"\330\212\250\367\336\317\002\002\347\102\363\217\336\333\367\157"
	"\047\155\213\105\175\344\177\004\102\152\357\200\302\230\332\167"
	"\210\137\247\002\211\066\101\271\371\251\031\172\063\061\261\157"
	"\274\122\203\034\171\031\366\003\052\272\136\111\352\201\136\276"
	"\251\164\225\220\103\152\160\373\020\052\245\012\336\112\147\233"
	"\222\246\116\213\307\365\207\251\012\010\244\033\151\120\374\246"
	"\146\215\334\126\254\040\220\370\337\274\375\161\215\315\103\173"
	"\173\267\060\325\114\354\011\105\000\345\357\116\300\136\216\213"
	"\071\146\250\221\254\152\356\301\140\050\207\303\273\022\205\113"
	"\242\156\131\036\045\044\367\004\162\041\213\277\031\044\373\334"
	"\355\001\355\036\263\173\202\017\213\226\122\212\117\253\011\257"
	"\064\257\114\213\171\076\306\251\273\374\016\320\014\273\023\201"
	"\061\370\241\253\226\260\125\120\122\043\337\203\255\345\317\263"
	"\130\224\034\164\332\314\332\223\005\333\250\006\055\044\061\323"
	"\006\366\004\250\063\320\023\171\014\105\312\007\360\262\320\220"
	"\311\030\053\263\365\066\047\022\210\052\251\117\313\005\245\125"
	"\116\217\107\052\356\160\025\143\066\161\132\357\105\046\372\304"
	"\366\135\062\120\302\036\071\352\242\266\277\136\266\161\152\230"
	"\272\061\153\302\134\364\133\112\116\276\132\365\174\145\047\042"
	"\137\244\266\013\246\162\150\074\366\176\040\076\377\170\032\315"
	"\217\060\357\350\264\352\072\156\026\133\322\115\244\104\257\012"
	"\003\220\357\024\311\146\044\103\240\100\311\117\316\055\132\312"
	"\305\051\144\325\105\007\115\340\022\236\333\210\231\020\255\032"
	"\367\036\217\240\164\310\312\314\117\077\321\365\350\074\325\111"
	"\325\372\377\155\204\350\214\267\272\310\325\356\133\113\245\241"
	"\102\034\154\124\156\232\372\156\376\012\270\352\053\235\033\313"
	"\052\217\141\227\026\245\003\040\230\006\117\364\065\017\011\234"
	"\175\302\205\141\257\317\145\332\176\311\340\344\033\330\002\247"
	"\335\156\355\016\360\226\150\072\031\215\244\360\011\025\336\037"
	"\033\354\332\321\124\377\233\253\247\241\147\300\002\161\254\253"
	"\167\342\253\272\270\220\252\026\255\364\037\242\204\342\356\107"
	"\047\165\000\007\213\063\162\226\302\153\261\305\262\345\313\170"
	"\231\077\357\214\317\227\014\064\225\126\062\054\016\217\346\136"
	"\372\214\133\304\371\221\022\155\103\017\151\351\013\034\367\115"
	"\026\110\242\122\047\161\131\147\323\056\257\375\000\250\343\034"
	"\311\201\222\253\135\242\214\234\170\220\016\107\264\234\035\310"
	"\240\156\321\255\232\105\306\151\344\376\355\141\106\012\034\055"
	"\203\001\346\107\171\020\240\057\340\053\336\343\311\267\141\027"
	"\043\121\142\317\243\243\237\160\237\224\064\233\023\375\022\320"
	"\177\222\023\241\303\045\150\344\016\331\111\205\075\337\166\330"
	"\267\213\106\324\207\065\051\361\035\335\256\301\141\156\134\006"
	"\227\017\037\077\221\075\042\102\213\124\107\016\171\307\310\075"
	"\307\022\316\117\163\125\332\065\034\335\247\111\122\257\047\034"
	"\013\172\014\261\375\266\240\323\252\165\172\163\133\130\056\166"
	"\161\321\175\132\072\014\170\257\266\212\265\373\016\355\204\122"
	"\231\127\124\160\157\316\265\251\276\127\267\352\061\364\154\304"
	"\063\267\063\254\026\324\255\147\273\172\307\105\035\226\365\136"
	"\133\341\245\052\337\073\201\015\354\127\133\126\247\360\231\240"
	"\167\272\174\055\256\146\050\306\321\132\254\305\221\331\140\037"
	"\312\052\273\007\241\067\260\301\350\071\300\125\021\037\241\263"
	"\247\245\011\103\257\301\122\170\050\324\046\154\061\266\053\017"
	"\027\153\350\276\361\104\234\242\213\001\001\263\171\352\134\076"
	"\362\340\237\377\055\253\167\001\041\335\020\327\176\106\340\207"
	"\222\264\042\046\071\140\213\105\045\255\075\033\337\224\024\037"
	"\226\121\370\154\336\056\101\007\173\202\371\057\303\052\253\103"
	"\110\342\035\055\101\325\124\243\157\324\146\341\342\004\302\356"
	"\167\302\110\132\105\213\321\240\250\215\244\354\217\271\257\223"
	"\132\120\206\057\163\332\156\043\367\311\266\226\312\000\261\344"
	"\370\252\115\225\024\075\225\375\333\323\332\140\112\352\044\033"
	"\004\217\042\230\102\042\261\110\122\353\235\040\223\373\021\001"
	"\010\261\032\211\224\144\125\102\137\122\142\235\217\052\110\133"
	"\312\352\072\373\325\142\113\232\141\136\004\137\070\371\005\354"
	"\267\250\004\132\374\054\302\173\042\221\261\036\022\021\360\305"
	"\371\326\075\035\160\001\256\143\314\245\171\127\304\060\371\021"
	"\163\300\257\363\044\350\216\377\124\127\272\361\316\220\176\014"
	"\200\232\317\276\362\370\134\020\332\312\076\171\306\174\025\247"
	"\210\056\047\176\001\103\001\120\357\331\067\341\340\260\327\053"
	"\104\340\255\171\175\000\070\337\165\262\321\016\110\241\357\363"
	"\025\331\236\143\105\270\017\154\074\256\013\160\273\211\220\342"
	"\273\032\033\063\111\307\002\246\166\213\270\060\144\105\253\213"
	"\203\201\046\364\255\045\344\020\066\152\235\045\072\122\113\144"
	"\115\146\070\011\015\020\206\137\243\072\154\170\231\373\117\346"
	"\025\142\145\156\355\051\337\162\326\001\045\133\073\040\052\344"
	"\377\366\013\054\224\050\330\236\005\265\147\314\204\142\240\255"
	"\114\000\235\220\235\224\201\064\011\333\260\066\070\213\217\034"
	"\050\176\034\130\230\055\306\154\350\316\333\351\067\061\243\335"
	"\365\137\027\271\161\161\102\053\364\165\371\133\252\302\374\267"
	"\243\045\334\045\023\056\066\262\152\304\152\356\020\254\013\312"
	"\357\346\312\371\023\247\163\324\244\050\303\300\272\167\306\316"
	"\055\010\377\104\163\224\006\352\156\344\371\240\227\140\243\144"
	"\107\155\136\133\025\322\060\271\372\363\172\265\152\100\203\230"
	"\110\203\334\274\027\343\247\205\310\240\046\137\000\311\304\110"
	"\067\042\243\115\364\323\006\357\307\200\244\061\300\047\312\011"
	"\252\246\306\302\212\155\107\122\015\156\262\016\070\166\127\160"
	"\231\372\275\216\316\304\175\225\105\042\307\006\111\221\017\364"
	"\070\325\267\302\103\377\025\121\155\307\140\246\076\267\026\327"
	"\261\323\146\200\227\343\025\335\005\334\343\117\156\362\104\246"
	"\310\373\151\014\373\176\135\150\106\275\016\204\164\045\134\046"
	"\371\302\246\221\246\274\156\253\230\121\373\007\103\100\256\014"
	"\074\027\030\067\226\166\240\334\063\257\141\250\324\275\316\315"
	"\177\165\136\045\061\314\321\312\035\315\321\141\016\200\156\112"
	"\227\207\202\056\375\042\012\060\321\153\331\246\051\247\163\250"
	"\035\322\316\117\236\240\031\274\156\353\036\174\153\214\307\003"
	"\023\111\061\020\154\074\101\076\247"
#define      tst2_z	19
#define      tst2	((&data[4273]))
	"\302\130\172\337\366\121\201\022\162\165\004\305\300\152\112\351"
	"\225\167\205\244\307\153\037\052\110\056\311"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
